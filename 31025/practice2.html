<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="../util/jquery-3.7.1.js"></script>
    <style>
        .container {
            margin: 50px auto;
            width: 500px;
        }

        .chatContent {
            overflow: auto;
            word-break: break-all;
            height: 350px;
            border: 1px solid #9b9b9b;
            padding: 5px;
        }

        .chatMessage {
            display: flex;
            margin-bottom: 30px;
        }

        .chatMessage > div {
            margin-left: 5px;
        }

        .userName {
            color: blue;
        }

        .message {
            background-color: #d7d7d7;
            padding: 5px 10px;
            border-radius: 10px;
            margin-right: 10px;
        }

        .sendMessage {
            height: 130px;
            border: 1px solid #9b9b9b;
            padding: 5px;
        }

        .sendMessageContent {
            word-break: break-all;
            overflow: auto;
            height: 100px;
        }

        .sendMessageContent:focus {
            /*outline: 1px solid #d9d9d9;*/
            outline: none;
        }

        .chatBar {
            height: 20px;
            border: 1px solid #9b9b9b;
            padding: 5px;
            background-color: #E7EEF9;
        }

        .opButton {
            background-color: #069DD5;
            color: white;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
            float: right;
            margin-left: 5px;
        }

        /*.chatMessage > span .chatMessage > img {*/
        /*    float: left;*/
        /*}*/


        * {
            /*border: 1px dashed blue;*/
        }

        /*div {*/
        /*    width: 100px;*/
        /*    height: 100px;*/
        /*    font-size: 30px;*/
        /*    border: 1px dashed blue;*/
        /*    !*使文本可以换行显示*!*/
        /*    word-break: break-all;*/
        /*    overflow: auto;*/
        /*}*/
    </style>
</head>
<body>
<main class="container">
    <div class="chatContent">
        <div class="chatMessage">
            <img src="../oneshop/resource/images/per_1.jpg" alt="" width="50px" height="50px">
            <div>
                <span class="userName">时尚伊人</span>
                <div class="message">你好，我是时尚伊人，很高兴为您服务!</div>
            </div>
        </div>

        <div class="chatMessage">
            <img src="../oneshop/resource/images/per_1.jpg" alt="" width="50px" height="50px">
            <div>
                <span class="userName">时尚伊人</span>
                <div class="message">你好，我是时尚伊人，很高兴为您服务!</div>
            </div>
        </div>

        <div class="chatMessage">
            <img src="../oneshop/resource/images/per_1.jpg" alt="" width="50px" height="50px">
            <div>
                <span class="userName">时尚伊人</span>
                <div class="message">
                    你好，我是时尚伊人，很高兴为您服务!你好，我是时尚伊人，很高兴为您服务!你好，我是时尚伊人，很高兴为您服务!
                </div>
            </div>
        </div>

        <div class="chatMessage">
            <img src="../oneshop/resource/images/per_1.jpg" alt="" width="50px" height="50px">
            <div>
                <span class="userName">时尚伊人</span>
                <div class="message">
                    你好，我是时尚伊人，很高兴为您服务!你好，我是时尚伊人，很高兴为您服务!你好，我是时尚伊人，很高兴为您服务!你好，我是时尚伊人，很高兴为您服务!你好，我是时尚伊人，很高兴为您服务!你好，我是时尚伊人，很高兴为您服务!你好，我是时尚伊人，很高兴为您服务!你好，我是时尚伊人，很高兴为您服务!
                </div>
            </div>
        </div>

        <div class="chatMessage">
            <img src="../oneshop/resource/images/per_1.jpg" alt="" width="50px" height="50px">
            <div>
                <span class="userName">时尚伊人</span>
                <div class="message">
                    你好，我是时尚伊人，很高兴为您服务!你好，我是时尚伊人，很高兴为您服务!你好，我是时尚伊人，很高兴为您服务!你好，我是时尚伊人，很高兴为您服务!
                </div>
            </div>
        </div>
    </div>
    <div class="chatBar">
        <img src="./resource/chatBar.png" alt="" height="20px">
        <img src="./resource/history.png" alt="" height="20px" style="float: right;">
    </div>
    <div class="sendMessage">
        <div class="sendMessageContent" contenteditable="true" id="sendTxtCont">
        </div>
        <span class="opButton" id="send">
            发送(s)
        </span>
        <span class="opButton" id="cancel">
            关闭(c)
        </span>
    </div>

</main>
</body>

<script>

    // const escapeHTML = function (str) {
    //     return str.replace(/&/g, '&amp;')
    //         .replace(/</g, '&lt;')
    //         .replace(/>/g, '&gt;')
    //         .replace(/"/g, '&quot;')
    //         .replace(/'/g, '&#039;');
    // }

    $(
        function () {
            $('#send').click(
                function () {
                    let $txt = $('#sendTxtCont');
                    let randomNum = Math.floor(Math.random() * 18) + 2;
                    let names = [
                        "流星雨下的夜",
                        "蓝天白云梦",
                        "小熊猫的快乐",
                        "雨后彩虹桥",
                        "风中的承诺",
                        "快乐的小蜜蜂",
                        "梦里花开花落",
                        "星空下的诺言",
                        "忧伤的小丸子",
                        "夜空中最亮的星",
                        "飘逸的风筝",
                        "落花流水情",
                        "无忧无虑的日子",
                        "简单爱生活",
                        "幸福的小鱼",
                        "傻笑不停的猫",
                        "温柔的月光",
                        "闲云野鹤"
                    ];
                    if ($txt.text().trim() === '') {
                        alert('发送内容不能为空');
                    } else {
                        $('.chatContent').append(`
                            <div class="chatMessage">
                                <img src="../oneshop/resource/images/per_${randomNum}.jpg" alt="" width="50px" height="50px">
                                <div>
                                    <span class="userName">${names[randomNum - 2]}</span>
                                    <div class="message">${$txt.html()}</div>
                                </div>
                            </div>
                        `);
                        $txt.empty();
                    }
                }
            )

            $('#cancel').click(
                function () {
                    window.close();
                }
            )

            $(document).keydown(
                function (e) {
                    // // alert(e.keyCode);
                    // if ((e.ctrlKey || e.metaKey) && (e.key === 's'||e.key === 'S')) {
                    //     e.preventDefault();
                    //     // alert('Ctrl+S has been disabled');
                    // }
                    if ((e.ctrlKey || e.metaKey) && e.keyCode === 83) {
                        e.preventDefault();
                        $('#send').click();
                    } else if ((e.ctrlKey || e.metaKey) && e.keyCode === 67) {
                        $('#cancel').click();
                    }
                }
            )
        }
    );

</script>

</html>